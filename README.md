# SendRegning Access Point REST based client API
Brief refactoring plan (remember to x out finished items).

### Rearranging modules
- [x] Refactor to remove webapp gui and test modules
- [x] Refactor to remove ibator and autogenerated iBatis classes
- [x] Refactor modules not used (difi-ws, dbms-schema, integration, export, import, security)
- [x] Make sure maven project still compiles and tests well

### Removing frameworks we no longer want or need
- [x] Remove all usage and references to Spring
- [x] Remove all usage and references to Struts
- [x] Remove all usage and references to iBatis
- [x] Remove all usage and references to Sitemesh
- [x] Remove runtime class manipulations (cglib-nodep)
- [x] Remove any jRebel references or dependencies
- [x] Make sure maven project still compiles and tests well

### Upgrade frameworks and tests (moving along to JSE8 minimum)
- [x] Update Maven 3 plugins and enforce JSE8 or higher
- [x] Removed htmlunit
- [x] Do we need both easymock and mockito (updated easymock version, removed references to mockito)
- [x] Do we need both junit and testng (update versions and stick with testng)
- [x] Do we really need both jetty and catalina during testing (updated jetty, removed catalina)
- [x] Removed old SR implementation of email (replaced it with a simple logging implementation)
- [x] mvn test now works without network (still needs database)
- [x] Move all online SMP tests as integration tests
- [x] Move all online MYSQL tests as persistence tests
- [x] Make sure all "mvn test" runs without network, redis, mail, mysql and oxalis-home
- [x] mvn test -> should just do unit tests (no dependencies on other systems/infrastructure)
- [x] mvn verify -> should trigger integration tests (maven-failsafe-plugin)

### Prepare and deploy version to DIFI
- [x] Remove any remaining references to old SR modules
- [x] Remove any SR/Unit4 usernames, password, hostnames (wordpress, jenkins, nagios etc)
- [x] Remove nexus and github references
- [x] Remove any SR/Unit4 servers, hostnames, ips (192.168.*) from config and files
- [x] Remove links to Struts and Account pages webpages ending in ".action" or ".do"
- [x] Look thru @todo, @fixme and @authors
- [x] Remove any keystores (*.jks) files (used in OxalisDocumentSender)
- [x] Remove links to ap.unit.com and ap-test.unit4.com (ringo.domain.com and ringo-test.domain.com)
- [x] Make sure database scripts will create the correct tables (see : create-oxalis-dbms.sql)
- [x] Tag last versjon with UNIT4 features as "vefa-srest-0.0"
- [x] Remove special handling of messages on the "UNIT4_*" channels (left TEST_ONLY channel)
- [x] Remove U4TS SMP Cleansing from /directory/query resource
- [x] Remove U4TS LOOKUP Currencies, Bronnoysund, Postal Codes REST calls
- [x] Remove U4TS EVENTS REST calls
- [x] Remove any usage and dependencies on Redis (jedis used from currency rates)
- [x] Make sure maven clean builds and tests with clean repo (mvn -Dmaven.repo.local=/tmp/m2 clean install)
- [x] Upload code to difi-srest (do __not__ bring over the complete Unit4 git history)
- [x] Tag last versjon with UNIT4 features as "vefa-srest-1.0"

### Defects and features that should be fixed
- [ ] PeppolDocumentSender (and implementations) can be found in both oxalis and peppol packages
- [ ] SMP lookups constructs the ProfileID from DocumentID/CustomizatonID (should use the real SMP value)
- [ ] Make sure the client version detection works and alerts are logged (for Ringo Client)
- [ ] Verify inbound messages belonging to us (receiver connected to account)
- [ ] Verify outbound messages parameters actually matching what's specified in the document
- [ ] Validate messages both inbound and outbound
- [ ] Hardcoded ADMIN_USERNAME ("sr-admin") should be changes (used when logging in as other users)

### Other changes (unordered)
- [x] Removed the SmpRegistrationClient that registered new accounts directly into ELMA
- [x] Moved artifacts naming from no.sr.ringo to no.difi.ringo (to prevent further dependency conflicts)
- [x] Remove BILLING from scope (code, tests, sql)
- [ ] Consider removing REST functionality that adds users, send mails and do other admin chores
- [ ] Remove as much as possible of apache + commons bloat
- [ ] Make some persistence methods as user supplied components (provide default impl)
- [ ] Ringo has it's own version of API classes from Oxalis (should just rely on Oxalis API)
- [ ] Should not store messages in database
- [ ] Look thru the logging usage and make sure we just use slf4j
- [ ] Remove any unused dependecies (run : mvn dependency:analyze)
- [ ] Upgrade old 6.x Tomcat (https://tomcat.apache.org/migration.html) or JEE7 (WildFly?)
- [ ] References to ringo.domain.com should point to the production server (scripts and download urls)
- [ ] References to ringo-test.domain.com should point to the test server (scripts and download urls)

### Refactor code to really use JSE8 features (and standard JEE7 specs - just one single dependency)
- [ ] Replace JodaTime with JSE8 LocalData, LocalTime variants
- [ ] Replace jaxen, jdom and ws implementations with built in alternatives (JAXB, JAXP, JAXWS are built in to JSE8)
- [ ] Replace json and rest implementations with standard alternatives (JSON-B, JSON-P, JAX-RS part of JEE7/8)
- [ ] Update direct usage of jersey and jackson to JAX-RS 2.0 (standard JEE7 spec)
- [ ] Example : com.sun.jersey.spi.container.ResourceFilters => javax.ws.rs.container.ContainerRequestContext
- [ ] Update Guice version and use standard CDI annotations (standard JEE7 spec)
- [ ] Example : com.google.inject.servlet.RequestScope => javax.enterprise.context.RequestScoped
- [ ] No need to manually concat XML (JAXB provides XML & JSON when using JAX-RS2 for free)
- [ ] Make sure maven project still compiles and tests well

### Add new features and improvements
- [ ] Add Swagger 2.0 API (JAX-RS 2.0 Swagger will automatically create up to date runtime documentation)
- [ ] Consider running whole server on wildfly-swarm or similar microservice plattform
- [ ] Consider rest-assured for testing REST (instead of hand coded httpclient tests)
- [ ] Consider ringo-email-impl as component (provide a default impl and let user provide their own)
- [ ] ? Add some kind of GUI mode to Ringo Client (swing / javafx / web)
- [ ] ? Does it make sense to add GUI mode to Ringo Standalone
- [ ] ? Add the REST version of the validator as a module (and use it in code)

Copyright (c) 2012 SendRegning AS, all rights reserved.
